# 2.1 네트워크의 기초

### **네트워크란?**

: 컴퓨터 등의 장치들이 통신 기술을 이용하여 구축하는 연결망.

- 노드(node)와 링크(link)가 서로 연결되어 있으며 리소스를 공유하는 집합
    - 노드(node) : 서버, 라우터, 스위치 등 네트워크 장치
    - 링크(link) : 유선 또는 무선을 의미

## 2.1.1. 처리량과 지연 시간

---

### 좋은 네트워크란?

: 많은 처리량을 처리 + 지연 시간이 짧음 + 장애 빈도가 적음 + 좋은 보안을 갖춤

### 처리량(Throughput)이란?

: 링크 내에서 성공적으로 전달된 데이터의 양 → 처리되는 **트래픽** 양

- 단위 : bps (bits per second) = 초당 전송 또는 수신되는 비트 수
- 트래픽 : 특정 시점에 링크 내에 흐르는 **데이터의 양**

### 지연 시간(latency)이란?

: 요청이 처리되는 시간 = 어떤 메시지가 두 장치 사이를 **왕복**하는데 걸리는 시간

## 2.1.2. 네트워크 토폴로지와 병목 현상

---

### 네트워크 토폴로지란?

: 노드와 링크의 배치 방식(연결 형식)

### 토폴로지 유형

1. **트리 토폴로지**
    - 트리 형태로 구성. 계층형 토폴로지
    - 장점
        - 노드의 추가, 삭제가 쉽다.
    - 단점
        - 특정 노드에 트래픽 집중 시 하위 노드에 영향을 끼칠 수 있다.
2. **버스 토폴로지**
    - 중앙 통신 회선 하나에 여러 개의 노드가 연결되어 공유
    - LAN(Local Area Network) 근거리 통신망에 사용
    - 장점
        - 중앙 통신 회선에 노드를 추가,삭제하기 쉽다.
        - 설치 비용이 적고 신뢰성이 우수하다
    - 단점
        - 스푸핑 :악의적인 노드에 패킷이 가도록 스위칭 기능을 마비시키거나 속임.
3. **스타 토폴로지**
    - 중앙에 있는 노드에 모두 연결된 구성
    - 장점
        - 노드 추가 쉬움.
        - 에러 탐지 쉬움. 중앙 노드가 아닌 노드에 장애가 발생하는 경우 다른 노드에 끼치는 영향 적음
        - 패킷의 충돌 가능성 적음
    - 단점
        - 중앙 노드에 장애 발생 시 전체 네트워크 사용 불가
        - 설치 비용 비쌈
4. 링형 토폴로지
    - 각각의 노드가 양 옆의 두 노드와 연결 → 고리모양.
    - 데이터가 노드에서 노드로 이동하며 각각의 노드는 고리 모양의 길을 통해 패킷 처리
    - 장점
        - 노드 수가 증가되어도 네트워크 상의 손실 거의 없음.
        - 충돌 발생 가능성 적음
        - 노드의 고장 발견 쉬움
    - 단점
        - 네트워크 구성 변경의 어려움
        - 회선에 장애 발생 시 전체 네트워크에 영향을 줄 수 있음
5. 메시 토폴로지
    - 그물망처럼 연결된 구조
    - 장점
        - 한 단말 장치에 장애 발생해도 여러 경로 존재 → 네트워크 계속해서 사용 가능 + 트래픽 분산 처리 가능
    - 단점
        - 노드의 추가 어려움(다 연결해줘야함.)
        - 구축 비용과 운용 비용이 고가

### 병목 현상(bottleneck)

: 전체 시스템의 성능이나 용량이 하나의 구성 요소로 인해 제한을 받는 현상

- 이해! 병의 몸통보다 목 부분 지름이 좁아서 물이 상대적으로 천천히 쏟아짐!
    - 물 → 트래픽
- ex. 서비스에서 이벤트를 열었을 때, 트래픽 증가 → 트래픽 관리를 못하면 병목 현상 발생 → 웹 사이트 사용 불가
- 병목 현상의 원인
    - 네트워크 대역폭
    - 네트워크 토폴로지
    - 서버 CPU, 메모리 사용량
    - 비효율적인 네트워크 구성

## 2.1.3. 네트워크 분류

---

- 규모를 기반으로 분류
    - LAN(Local Area Network)
        - 근거리 통신망
        - 같은 건물, 캠퍼스, 사무실, 개인적으로 소유 가능한 규모
    - MAN(Metropolitan Area Network)
        - 대도시 지역 네트워크
        - 시 정도의 규모
    - WAN(Wide Area Network)
        - 광역 네트워크
        - 국가 / 대륙 같은 지역에서 운영
- 혼잡도 : LAN < MAN < WAN
- 속도 : LAN > MAN > WAN

## 2.1.4. 네트워크 성능 분석 명령어

---

상황) 애플리케이션 코드 상에 문제X. 사용자가 서비스로부터 데이터를 가져오지 못하는 상황 발생

→ 네트워크 [병목 현상(bottleneck)](https://www.notion.so/bottleneck-290ad48953d7808e8131dd29bc771a08?pvs=21) 일 가능성 존재.

→ 네트워크 관련 테스트 & 네트워크와 무관한 테스트 모두 진행

→ 네트워크 관련 문제인 것이 확인된 경우 **네트워크 성능 분석**

→ 네트워크 성능 분석 시 사용하는 명령어

### Ping(Packet INternet Groper)

: 네트워크 상태를 확인하려는 대상 노드를 향해 일정 크기의 패킷을 전송하는 명령어

- 명령어 사용법 : `ping [www.google.com](http://www.google.com) -n 12`
    - `-n 12` 옵션을 통해 12번의 패킷을 보내고 받음.
- **Ping**을 통해 알 수 있는 것
    - 해당 노드의 패킷 수신 상태
    - 해당 노드에 패킷이 도달하기까지의 시간
    - 해당 노드까지 네트워크가 잘 연결되어 있는지
- 특징
    - ICMP프로토콜을 통해 동작
        
        → ICMP 프로토콜을 지원하지 않는 기기를 대상으로 실행할 수 없음.
        
        → ICMP나 traceroute를 차단하는 대상의 경우 ping 테스트 불가.
        

### netstat

: 접속되어 있는 서비스들의 네트워크 상태 표시에 사용 & 서비스의 포트가 열려 있는지 확인할 때 사용

- 특징
    - 네트워크 접속, 라우팅 테이블, 네트워크 프로토콜 등 리스트를 보여줌.

### 병목 현상(bottleneck)

### nslookup

: DNS에 관련된 내용(**도메인에 매핑된 IP 확인** 시)을 확인하기 위해 사용

### tracert (Linux: traceroute)

: 목적지 node까지의 네트워크 겨올 확인 시 사용

- 어느 구간에서 응답 시간이 느려지는지 확인 가능

## 2.1.5 네트워크 프로토콜 표준화

---

### 네트워크 프로토콜이란?

: 다른 장치들끼리 데이터를 주고받기 위해 설정된 공통된 인터페이스

- 표준화 단체(IEEE or IETF)에서 결정
- IEEE802.3 : 유선 LAN 프로토콜. 유선으로 LAN을 구축할 때 쓰이는 프로토콜
- HTTP : 웹 접속 시 사용하는 프로토콜

# 2.2 TCP/IP 4계층 모델

### 인터넷 프로토콜 스위트(Internet Protocol Suite)

: 인터넷에서 컴퓨터들이 서로 정보를 주고받는데 쓰이는 프로토콜의 집합

→ TCP/IP 4계층 모델로 설명 / OSI 7계층 모델로 설명

## 2.2.1. 계층 구조

---

### TCP/IP 계층             OSI 7계층

[애플리케이션 계층]        [애플리케이션 계층]

                                           [프레젠테이션 계층]

                                           [세션 계층]

---

[전송 계층]                        [전송 계층]

---

[인터넷 계층]                    [네트워크 계층] 

---

[링크 계층]                        [데이터 링크 계층]

                                           [물리 계층]

---

- 특정 계층이 변경되어도 다른 계층이 영향을 받지 않도록 설계됨.

### 애플리케이션 계층

- 응용 프로그램이 사용되는 프로토콜 계층
- ex. FTP, HTTP, SSH, SMTP, DNS
- 서비스를 실질적으로 사람들에게 제공하는 층

### 전송 계층

- 송신자와 수신자를 연결하는 통신서비스 제공.
- 연결 지향 데이터 스트림 지원, 신뢰성, 흐름 제어 제공
- 애플리케이션과 인터넷 계층 사이의 데이터 전달 시 중계 역할
- ex. **TCP & UDP**
    - **TCP (신뢰성 있는 계층)**
        - 패킷 사이의 순서 보장 → 신뢰성 구축, 수신 여부 확인 → ‘가상회선 패킷 교환 방식’ 사용
        - ‘가상회선 패킷 교환 방식’
            - 각 패킷에 가상회선 식별자 포함
            - 모든 패킷 전송 시 가상회선 해제
            - 패킷들은 전송된 순서대로 도착
        - 연결 성립 과정 : **3-way handshake**
            - 1단계 : SYN 단계. 클라이언트가 서버에 SYN(ISN담음)을 보냄
            - 2단계 : SYN+ACK 단계. 서버가 클라이언트 SYN 수신. 서버의 ISN을 보냄. 승인번호는 클라이언트의 ISN+1
            - 3단계 : ACK 단계. 클라이언트가 승인번호(서버의 ISN+1)를 담아 ACK를 서버에 보냄.
        - 연결 해제 과정 : 4-way handshake
            - TIME_WAIT을 하는 이유?
                - 지연 패킷 발생 대비
                - 두 장치가 연결이 닫혔는지 확인하기 위해
    - **UDP (신뢰성 없는 계층)**
        - 순서 보장 x. → 수신 여부 확인 x. → ‘데이터그램 패킷 교환 방식’ 사용
        - ‘데이터그램 패킷 교환 방식’
            - 패킷이 독립적으로 이동하며 최적의 경로 선택
            - 하나의 메시지에서 분할된 여러 패킷은 서로 다른 경로로 전송 가능
            - 전송된 순서와 다르게 도착할 수 있음

### 인터넷 계층

- 장치로부터 받은 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위해 사용되는 계층.
- ex. IP, ARP, ICMP 등
- 패킷을 수신해야 할 상대의 주소를 지정해 데이터 전달
- 비연결형적 특징 : 상대방이 제대로 받았는지에 대해 보장X.

### 링크 계층

- 링크, 광섬유, 무선 등 실질적으로 데이터를 전달하며 장치 간에 신호를 주고받는 규칙을 정하는 계층
- = 물리 계층(무선 LAN과 유선 LAN을 통해 0과 1로 이루어진 데이터를 보내는 계층) + 데이터 링크 계층(이더넷 프레임을 통해 에러 확인, 흐름 제어, 접근 제어 담당)
- 종류
    - 유선 LAN(IEEE802.3)
        - 전이중화 통신 : 양쪽 장치가 동시에 송수신할 수 있는 방식
        - CSMA/CD : 데이터를 보낸 이후 충돌 발생 시 일정 시간 후 재전송
    - 유선 LAN을 이루는 케이블
        - 트위스트 페어 케이블 : 여덟 개의 구리선을 두 개씩 꼬아서 묶은 케이블
        - 광섬유 케이블 : 광섬유로 만든 케이블. 장거리 및 고속 통신 가능.
    - 무선 LAN(IEEE802.11)
        - 반이중화 통신 : 수신과 송신에 같은 채널 사용. BUT, 동시에 통신 불가. 한 번에 한 방향만 가능.
        - CSMA/CA : 데이터를 보내기 전에 충돌은 방지하는 방식
    - 무선 LAN을 이루는 주파수 - 2.4GHz 대역과 5GHz 중 하나를 써서 구축.
        - 와이파이 : 무선 접속 장치 즉, 공유기 필요.
        - BSS : 근거리 무선 통신 제공
        - ESS : 하나 이상 연결된 BSS 그룹. 장거리 무선 통신 제공
    - 이더넷 프레임
        - 이더넷 프레임을 통해 전달받은 데이터의 에러 검출 & 캡슐화

### 계층 간 데이터 송수신 과정

- 사용자의 애플리케이션 계층에서 캡슐화
- 링크 계층을 통해 서버와 통신
- 서버의 링크 계층에서 애플리케이션 계층까지 비캡슐화
- **캡슐화 과정**
    - 모든 계층 = 헤더 + 데이터
    - 하위 계층 = 헤더 + 데이터(상위 계층의 헤더+데이터+ 하위 계층의 데이터)
- **비캡슐화 과정**
    - 각 계층의 헤더 부분을 제거하는 과정

## 2.2.2. PDU

---

### PDU(Protocol Data Unit)란?

: 네트워크의 어떤 계층에서 계층으로 데이터가 전달될 때의 한 덩어리 단위

- PDU = 헤더 + 페이로드(데이터)
    - 애플리케이션 계층 : 메시지
    - 전송 계층 : 세그먼트(TCP), 데이터그램(UDP)
    - 인터넷 계층 : 패킷
    - 링크 계층 : 프레임(데이터 링크 계층), 비트(물리 계층)

# 2.3 네트워크 기기

## 2.3.1. 네트워크 기기의 처리 범위

---

: 계층별로 처리할 수 있는 기기가 다르다.

- 애플리케이션 계층 : L7 스위치
- 인터넷 계층 : 라우터, L3 스위치
- 데이터 링크 계층 : L2 스위치, 브릿지
- 물리 계층 : NIC, 리피터, AP
- 상위 계층의 기기는 하위 계층을 처리할 수 있으나 그 반대는 성립하지 않는다.

## 2.3.2. 애플리케이션 계층을 처리하는 기기

---

### 스위치

: 여러 장비를 연결하고 데이터 통신을 중재하며 목적지가 연결된 포트로만 전기 신호를 보내 데이터를 전송하는 통신 네트워크 장비

### L7 스위치

- 서버의 부하를 분산
- 시스템이 처리할 수 있는 트래픽 증가를 목표로 함.
- 트래픽 분산 / 필터링 / 트래픽 모니터링 등의 기능

### 로드 밸런서를 이용한 서버 이중화

- 서비스의 안정적 운용을 위해 2대 이상의 서버는 필수
- 2대 이상의 서버를 기반으로 가상 IP 제공

## 2.3.3. 인터넷계층을 처리하는 기기

---

### 라우터

: 여러 개의 네트워크를 연결, 분할, 구분시켜주는 역할.

- **라우팅** : IP 주소를 찾아가는 과정
    - 다른 네트워크에 존재하는 장치끼리 서로 데이터를 주고받을 때 패킷 소모를 최소화하고 경로를 최적화하여 최소 경로로 패킷을 포워딩
- 소프트웨어 기반의 라우팅 + 하드웨어 기반의 라우팅

### L3 스위치

- L2 스위치의 기능 + 라우팅 기능.
- 하드웨어 기반의 라우팅 담당

## 2.3.4. 데이터 링크 계층을 처리하는 기기

---

### L2 스위치

- MAC 주소 테이블을 통해 장치들의 MAC 주소 관리
- 패킷 전송 담당
- IP 주소 기반의 라우팅 불가. → MAC 주소를 읽어 스위칭

### 브리지(Bridge)

: 두 개의 LAN을 상호 접속할 수 있도록 하는 통신망 연결 장치

- MAC 주소 테이블에 MAC 주소 관리
- 통신망 범위 확장 및 서로 다른 LAN으로 이루어진 하나의 통신망 구축 시 사용

## 2.3.5. 물리 계층을 처리하는 기기

---

### NIC (Network Interface Card)

= LAN 카드

- 2대 이상의 컴퓨터 네트워크 구성 시 사용
- 네트워크와 빠른 속도로 데이터를 송수신 할 수 있도록 컴퓨터에 설치하는 카드
- 각각 고유 식별번호인 MAC 주소 존재

### 리피터(Repeater)

: 들어오는 약해진 신호 정도를 증폭해 다른 쪽으로 전달하는 장치

- 광케이블의 보급으로 현재 잘 사용x.

### AP(Access Point)

: 패킷 복사 기기

- AP에 유선 LAN 연결 → 다른 장치에서 무선 LAN 기술을 사용해 무선 네트워크 연결 가능

# 2.4 IP 주소

## 2.4.1. ARP

---

### ARP(Address Resolution Protocol)이란?

: IP 주소로부터 MAC 주소를 구하는 프로토콜. (IP와 MAC 주소의 다리 역할)

- 가상 주소인 IP → 실제 주소인 MAC 주소로 변환
- RARP : 실제 주소인 MAC 주소 → 가상 주소인 IP 주소로 변환

## 2.4.2. 홉바이홉 통신

---

### 홉바이홉 통신이란?

: IP 주소를 통해 통신하는 과정

### 라우팅 테이블(Routing Table)

- 라우터에 들어가 있는 목적지 정보들과 그 목적지로 가기 위한 방법이 들어 있는 리스트
- 게이트웨이 & 모든 목적지에 대해 해당 목적지에 도달하기 위해 거쳐야 할 다음 라우터의 정보 O.

### 게이트웨이

: 서로 다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문 역할을 하는 컴퓨터나 소프트웨어

- 서로 다른 네트워크상의 통신 프로토콜을 변환해주기도 함.
- 라우팅 테이블을 통해 확인 가능 (netstat -r)

   

## 2.4.3. IP 주소 체계

---

### IP 주소체계

- IPv4 : 32비트를 8비트 단위로 점을 찍어 표기 ex. 123.45.67.89
- IPv6 : 64비트를 16비트 단위로 점을 찍어 표기 ex. 2001:db8::ff00:42:8329
- 가장 많이 쓰는 주소 체계 : IPv4

### 클래스 기반 할당 방식

: A,B,C(일대일 통신),D(멀티캐스트 통신),E(예비용) 다섯 개의 클래스로 구분.

- 네트워크 주소 + 호스트 주소

### DHCP(Dynamic Host Configuration Protocol)

: IP 주소 및 기타 통신 매개변수를 자동으로 할당하기 위한 네트워크 관리 프로토콜

- 인터넷에 접속할 때마다 자동으로 IP 주소 할당 가능
- 라우터와 게이트웨이 장비에 해당 기능 존재 → 가정용 네트워크에서 IP 주소 할당

### NAT(Network Address Translation)

: 패킷이 라우팅 장치를 통해 전송되는 동안 패킷의 IP 주소 정보를 수정하여 IP 주소를 다른 주소로 매핑하는 방법

- 공인 IP와 사설 IP로 나눠서 처리
- NAT를 가능하게 하는 소프트웨어 : ICS, RRAS, Netfilter
- 여러 대의 호스트가 하나의 공인 IP 주소를 사용해 인터넷에 접속하기 위해 사용
- 내부 네트워크에서 사용하는 IP 주소와 외부에 드러나는 IP 주소를 다르게 유지 가능 → 네부 네트워크에 대한 보안 가능
- 여러 명이 동시에 접속 → 접속 속도가 느려질 수 있음

# 2.5 HTTP

## 2.5.1. HTTP/1.0

---

- 한 연결당 하나의 요청을 처리하도록 설계 → RTT 증가 야기
    - RTT : 패킷 왕복 시간. 패킷이 목적지에 도달하고 나서 다시 출발지로 돌아오기까지 걸리는 시간

### RTT 증가 해결 방법

1. 이미지 스플리팅
    
    : 많은 이미지가 합쳐 있는 하나의 이미지 다운로드 → background-image의 position 이용해 이미지 표기
    
2. 코드 압축
    
    : 개행 문자, 빈칸을 제거해 코드 크기 최소화
    
3. 이미지 Base64 인코딩
    
    : 이미지 파일을 64진법으로 이루어진 문자열로 인코딩
    
    - 서버와의 연결을 열고 이미지에 대해 서버에 http 요청을 할 필요 x.
    - 크기가 커지는 단점

## 2.5.2. HTTP/1.1

---

- 한 번 TCP 초기화 → keep-alive 옵션으로 여러 개의 파일 송수신 가능
- 즉, 한 번의 TCP 3-way handshake를 한다.
- 대기 시간이 길어지는 단점 존재
- HTTP/1.1의 헤더에 많은 메타데이터(EX. 쿠키)가 들어있어 압축이 되지 않아 무거움.

### HOL Blocking(Head Of Line Blocking)

: 같은 큐에 있는 패킷이 그 첫 번째 패킷에 의해 지연될 때 발생하는 성능 저하 현상

## 2.5.3. HTTP/2

---

- HTTP/1.X 보다 지연 시간 감소, 응답 시간 감소.

### 멀티플렉싱

: 여러 개의 스트림을 사용해 송수신

- 특정 스트림의 패킷이 손실되어도 해당 스트림에만 영향을 미치고 나머지 스트림은 정상 동작
    - 스트림 : 시간이 지남에 따라 사용할 수 있게 되는 일련의 데이터 요소를 가리키는 데이터 흐름
    
    → 단일 연결을 사용해 병렬로 여러 요청 받고 응답 줄 수 있음
    
    → HOL Blocking 해결 가능
    

### 헤더 압축

- 허프만 코딩 압축 알고리즘을 사용하는 HPACK 압축 형식
    - 허프만 코딩 : 문자열을 문자 단위로 쪼개 빈도수를 세어 빈도가 높은 정보는 적은 비트 수를 사용해 표현 , 빈도가 낮은 정보는 비트 수를 많이 사용해 표현

### 서버 푸시

- 클라이언트 요청 없이 서버가 바로 리소스 푸시 가능

## 2.5.4. HTTPs

---

- HTTP2가 HTTPs 위에서 동작
- 애플리케이션 계층과 전송 계층 사이에 SSL/TLS 계층(신뢰 계층)을 넣은 신뢰할 수 있는 HTTP 요청

### SSL/TLS

: 전송 계층에서 보안을 제공하는 프로토콜

- 제 3자가 메시지를 도청하거나 변조하지 못하도록 함.
- 인터셉트 방지 가능
- 보안 세션을 기반으로 데이터 암호화
    - **보안 세션**
    - : 보안이 시작되고 끝나는 동안 유지되는 세션
    - 클라이언트와 서버가 키를 공유하고 이를 기반으로 인증, 인증 확인
- 보안 세션 생성 시 인증 메커니즘, 키 교환 암호화 알고리즘, 해싱 알고리즘 사용
    - **인증 매커니즘**
        - CA(Certificate Authorities)에서 발급한 인증서를 기반으로 이루어짐.
        - 공개키를 클라이언트에 제공 & 사용자가 접속한 서버가 신뢰할 수 있는 서버임을 보장
        - 인증서 = 서비스 정보 + 공개키 + 지문 + 디지털 서명
        - CA ex. Comodo, GoDaddy, GlobalSign, 아마존 등
    - **암호화 알고리즘**
        - 디피-헬만 키 교환 암호화 알고리즘 : $y=g^x mod p$ 에서 g&x&p를 알 경우 y를 구하기 쉽지만 y & p만 아는 경우 x를 구하기 어렵다는 원리에 기반
        - 공개 값 공유 → 각자의 비밀 값과 혼합 → 혼합 값 공유 → 각자의 비밀 값과 혼합 → 공통의 암호키인 PSK 생성
    - **해싱 알고리즘**
        - SSL/TLS는 해싱 알고리즘
        - SHA-256 알고리즘 : 해시 함수의 결과값이 256비트인 알고리즘
            - 블록체인 시스템에서 활용
            - 해싱을 해야 할 메시지에 전처리 → 전처리된 메시지를 기반으로 해시 반환

### SEO에도 도움이 되는 HTTPS

: 검색엔진 최적화 = 검색엔진으로 웹 사이트 검색했을 때, 그 결과를 페이지 상단에 노출시켜 많은 사람이 볼 수 있도록 최적화한 방법

1. 캐노니컬 설정
2. 메타 설정
3. 페이지 속도 개선
4. 사이트맵 관리

### HTTPS 구축 방법

1. CA에서 구매한 인증키를 기반으로 구축
2. 서버 앞단의 HTTPS를 제공하는 로드밸런서 배치
3. 서버 앞단에 HTTPS를 제공하는 CDN 배치

## 2.5.5. HTTP/3

---

- QUIC라는 계층 위에서 돌아감.  UDP 기반이다. (HTTP/2는 TCP 위에서 돌아감.)
- 장점
    - 멀티플렉싱을 가지고 있음
    - 초기 연결 설정 시 지연 시간 감소
        - TCP를 사용X = 3-way handshake를 하지 않는다는 뜻.
        - 초기 연결 시 1-RTT만 소요
- 순방향 오류 수정 메커니즘(FEC, Forward Error Correction)이 적용되어있음.
    - 전송한 패킷 손실 시 수신 측에서 에러 검출 & 수정
    - 열악한 네트워크 환경에서도 패킷 손실률이 낮다.
